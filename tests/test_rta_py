import numpy as np
from ReduMetrics.metrics.rta import rta_score

def test_rta_returns_float_in_0_1():
    rng = np.random.default_rng(1)
    X_high = rng.normal(size=(20, 6))
    X_low  = (X_high @ rng.normal(size=(6, 3))) + 0.01 * rng.normal(size=(20, 3))
    score = rta_score(X_high, X_low, T=200, random_state=123)
    assert isinstance(score, float)
    assert 0.0 <= score <= 1.0

def test_rta_is_reproducible_with_seed():
    rng = np.random.default_rng(2)
    X_high = rng.normal(size=(30, 4))
    X_low  = X_high @ rng.normal(size=(4, 2))
    s1 = rta_score(X_high, X_low, T=500, random_state=7)
    s2 = rta_score(X_high, X_low, T=500, random_state=7)
    assert s1 == s2

def test_rta_accepts_small_T():
    rng = np.random.default_rng(3)
    X_high = rng.normal(size=(25, 5))
    X_low  = X_high @ rng.normal(size=(5, 2))
    s = rta_score(X_high, X_low, T=5, random_state=0)
    assert 0.0 <= s <= 1.0
